---
title: Linux实操
date: 2020-10-08
categories:
- Back-End
tags:
- Linux
---

## 1.vi和vim编辑器

所有的Linux系统都会内建`vi`文本编辑器，而`vim`是`vi`的增强版，其具有程序编辑的能力等

**`vi`和`vim`的三种模式**：

- 一般模式

  以`vi`或`vim`打开一个文件就直接进入一般模式（这是默认的模式）。在该模式下，我们可以使用一些快捷键来操作文件，比如可通过“上下左右”按键来移动光标，或者通过“删除字符”或“删除整行”来处理档案内容， 也可以使用“复制”、“贴上”来处理你的文件数据

- 编辑模式

  在一般模式中可以进行删除、复制、贴上等动作，但是该模式是无法编辑文件内容的。在一般模式下，按下“i，l，o，O，a，A，r，R”之中任意一个字母才会进入编辑模式，此时就能编辑文件的内容了。如果要回到一般模式，必须要按下“Esc”按键才会退出编辑模式

- 命令行模式

  在一般模式中，输入”：/？“三个中的任意一个字符，光标就会移动到最下面，此时就进入到了命令行模式。在该模式下，可以通过相关指令，来进行读取、存盘、大量取代字符、离开`vi`、显示行号等等动作

三种模式转换图：

![image-20210525222942144](/static/img/image-20210525222942144.png)

**`vim`实操——使用vim编写一个Hello.java**

- 使用`vim Hello.java`进入一般模式![image-20210526081743802](/static/img/image-20210526081743802.png)

  `vim`后面跟的一定是文件名，无论该文件存在与否：

  - 如果不存在，则该操作将会打开一个新文件，文件最下面一行会显示![image-20210526082325646](/static/img/image-20210526082325646.png)
  - 如果存在，则该操作打开的是一个旧文件，文件最下面那一行会显示![image-20210526082605194](/static/img/image-20210526082605194.png)

  在一般模式下，可以通过快捷键完成一些操作：

  - `yy`：拷贝当前光标所在行
  - `nyy`：拷贝当前光标所在行及下面n行
  - `p`：粘贴拷贝的内容至当前光标所在处
  - `dd`：删除当前光标所在行
  - `ndd`：删除当前光标所在行及下面n行
  - `/`：查询`/`后的字符，按下回车查找，输入`n`就是查找下一个
  - `:set nu`：设置文件的行号
  - `:set nonu`：取消文件的行号
  - `G`：直接跳到文件最末行
  - `gg`：直接跳到文件最首行
  - `u`：撤销上一个操作
  - `shift+g`：跳转至指定行（先输入行号，再按下该组合键即可跳转至指定行）

- 按下“i，l，o，O，a，A，r，R”之中任意一个字母来进入编辑模式，在编辑模式下，文件最下面那一行会显示![image-20210526082814564](/static/img/image-20210526082814564.png)

- 编辑完成后，按下”Esc“来回到一般模式，再按下“:”来进入到命令行模式，此时可以通过指令：

  - `:wq`：保存并退出

  - `:wq!`：强制保存退出

    若编辑的文件，其权限是只读的，`root`用户可通过该指令强制将编辑的内容写入并退出

  - `:q`：不保存仅退出

    在对一个文件只进行读操作，而不涉及任何修改，在操作结束后可使用该指令退出文件

  - `:q!`：强制不保存退出

    若对一个文件进行了修改操作，但是并不想让修改后的内容保存，可使用该指令

## 2.开机、重启和用户登录注销

- 关机&重启命令

  - `shutdown`指令
    - `shutdown -h now`：表示立即关机
    - `shutdown -h n`：表示n分钟后关机
    - `shutdown -r now`：表示立即重启

  - `halt`指令

    直接使用，效果等价于关机

  - `reboot`指令

    重启系统

  - `sync`指令

    将内存的数据同步到磁盘（一般在关机或重启前，应该先执行该命令，让内存数据刷新到磁盘，防止数据丢失）

- 用户登录和注销

  - 一个用户登录后，可以使用`su 用户名`来切换登录其他用户（超级用户切换到普通用户是不需要密码的，而普通用户切换到超级用户是需要密码的）
  - 使用`logout`指令，即可注销当前登录用户，该指令在图形运行级别无效

## 3.用户管理

Linux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统，每个Linux用户都至少属于一个组

![image-20210526131953426](/static/img/image-20210526131953426.png)

- 添加用户

  - 指令

    `useradd [选项] 用户名`

    常用选项：

    - `-d`：指定新用户的根目录 
    -  `-g`：指定新用户所属组的名称或id（如果未指定该选项，默认系统会为新用户创建一个与其用户名相同的组，并将新用户放入该组）

  - 实操——添加一个`potato`用户（指定其根目录为`/home/temp`）

    ![image-20210526134728094](/static/img/image-20210526134728094.png)

- 给用户指定或者修改密码

  - 指令

    `passwd 用户名`

  - 实操——为`potato`用户指定密码

    ![image-20210526135428365](/static/img/image-20210526135428365.png)

- 删除用户

  - 指令

    `userdel [选项] 用户名`

    常用选项：

    - `-r`：删除用户根目录及邮件池

  - 实操

    - 删除用户potatao，但是保存其根目录

      ![image-20210526140100050](/static/img/image-20210526140100050.png)

    - 删除用户potato以及其根目录

      ![image-20210526140332533](/static/img/image-20210526140332533.png)

    删除用户时，一般不会将用户根目录删除

- 查询用户信息

  - 指令

    `id 用户名`

  - 实操——查询`root`用户信息

    ![image-20210526141521360](/static/img/image-20210526141521360.png)

- 切换用户

  - 指令

    `su 用户名`

  - 实操——切换到`potato`用户再退出至原来用户

    ![image-20210526142154838](/static/img/image-20210526142154838.png)

    - 使用`su potato`切换至`potato`用户（从权限高的用户切换到权限低的用户，不需要输入密码，反之需要）
    - 然后通过`exit`命令返回至原来用户

- 查看当前用户/登录用户

  - 指令

    `whoami`

- 用户配置文件

  用户配置文件记录了用户的各种信息，其路径为`/etc/passwd`

  该文件中每行记录的 格式为：`用户名:密码:用户id:组id:注释性描述:用户根目录:登录Shell`

  ![image-20210526151213923](/static/img/image-20210526151213923.png)

- 密码配置文件

  保存了加密后的密码信息

  该文件中每行记录的格式为：`登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志`

## 4.用户组管理

用户组，类似于角色，我们可以将有共性的多个用户放至一个组，方便系统统一的管理

- 增加组

  - 指令

    `groupadd 组名`

  - 实操——增加一个`just`组

    ![image-20210526143457252](/static/img/image-20210526143457252.png)

- 删除组

  - 指令

    `groupdel 组名`

  - 实操——删除`just`组

    ![image-20210526143809741](/static/img/image-20210526143809741.png)

- 添加用户时直接指定用户所属组

  - 指令

    `useradd -g 组名 用户名`

  - 实操——增加一个用户`zwj`，并指定其所属组为`wudang`

    ![image-20210526145311160](/static/img/image-20210526145311160.png)

    - 使用`groupadd wudang`创建一个`wudang`组
    - 然后通过指令`useradd -g wudang zwj`来完成

- 修改用户的组biaoshi

  - 指令

    `usermod -g 新的组名 用户名`

  - 实操——修改用户`zwj`所属组为`potato`

    ![image-20210526145641876](/static/img/image-20210526145641876.png)

- 组配置文件

  组配置文件记录了Linux包含的组的信息

  该文件每行记录的格式为：`组名:密码:组id:组内用户列表`

  ![image-20210526152257855](/static/img/image-20210526152257855.png)

## 5.运行级别

Linux共有7个运行级别

- 0：系统停机状态，系统默认运行级别不能设为0，否则不能正常启动
- 1：单用户工作状态，root权限，用于系统维护，禁止远程登陆
- 2：多用户无网络
- 3：多用户有网络
- 4：系统未使用，保留
- 5：图形界面
- 6：系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动

常用运行级别是3和5，如果要修改默认的运行级别，可以通过一些指令完成：

- 查看当前默认的运行级别

  - 指令

    `systemctl get-default`

  - 实操

    ![image-20210526154833543](/static/img/image-20210526154833543.png)

    输出显示当前默认运行级别为`graphical.target`，即运行级别5

- 修改默认的运行级别

  - 指令

    `systemctl set-default 对应的运行级别文件`

  - 实操——将当前默认运行级别修改为3

    ![image-20210526155405584](/static/img/image-20210526155405584.png)

    运行级别3对应的文件为`multi-user.target`

如果要从当前运行级别切换到其他运行级别，可通过以下指令`init [0123456]`完成

**实操——如何找回遗忘的root密码**

- 方法

  进入单用户模式，修改`root`密码，因为单用户模式下，`root`不需要密码就可以登录

- 步骤

  - 开机启动时出现下图界面时，按e键

    ![image-20210526162315965](/static/img/image-20210526162315965.png)

  - 按e键后出现下图界面时，找到utf-8这个位置

    ![image-20210526162644102](/static/img/image-20210526162644102.png)

  - 在该位置后添加`init=/bin/sh`，并将`ro`修改为`rw`，然后按`ctrl+x`执行，即可进入单用户模式

  - 在单用户模式下，使用指令`passwd`即可修改`root`密码

    ![image-20210526162938036](/static/img/image-20210526162938036.png)

- 注意

  单用户修改`root`密码这个操作，只有操作者在Linux系统所在的电脑旁才能成功，因为单用户模式是禁止远程登录的

## 6.实用指令

- 帮助指令

  - `man`指令

    - 语法

      `man [命令或配置文件]`（功能描述：获得帮助信息）

    - 实操——查看`ls`命令的帮助信息

      ![image-20210526165505904](/static/img/image-20210526165505904.png)

  - `help`指令

    - 语法

      `help 命令` （功能描述：获得 shell 内置命令的帮助信息）

    - 实操——查看`cd`命令的帮助信息

      ![image-20210526165629389](/static/img/image-20210526165629389.png)

- 文件目录类相关指令

  - `pwd`指令

    - 语法

      `pwd`（功能描述：显示当前所在目录的绝对路径）

    - 实操

      ![image-20210526165815282](/static/img/image-20210526165815282.png)

  - `ls`指令

    - 语法

      `ls [选项][目录或是文件]`（功能描述：显示指定目录下的内容。第二个可选项如果没有，则表示显示当前目录下的内容）

      常用选项：

      - `-a`：显示指定目录下所有的文件和目录，包括隐藏的（Linux下隐藏的目录和文件都是以符号`.`开头的）
      - `-l`：以列表的方式显示信息，即纵向的显示（默认是横向）

    - 实操——查看当前目录的所有内容信息

      ![image-20210526170727031](/static/img/image-20210526170727031.png)

  - `cd`指令

    - 语法

      `cd [参数]`（功能描述：切换到指定目录）

      常用参数：

      - `~`/不带参：回到当前用户的根目录
      - `..`：回到当前目录的上一级目录

    - 实操

      - 使用绝对路径切换到`root`目录

        `cd /root`

      - 使用相对路径切换到`root`目录（假设当前处于`/root/user/lib`目录下）

        `cd ../../`

      - 回到用户根目录

        `cd`/`cd ~`

  - `mkdir`指令

    - 语法

      `mkdir [选项] 目录名`（功能描述：创建目录）

      常用选项：

      - `-p`：创建多级目录

    - 实操

      - 在`/home/`目录下创建一个目录名为`dog`的目录

        ![image-20210526172229073](/static/img/image-20210526172229073.png)

      - 在`/home/`目录下创建多级目录`animal/tiger`

        ![image-20210526172525337](/static/img/image-20210526172525337.png)

        创建多级目录需要使用选项`-p`，因为默认情况下，`mkdir`指令只能一级一级创建目录

  - `rmdir`指令

    - 语法

      `mkddir [选项] 目录名`（功能描述：删除空目录）

    - 实操——删除空目录`/home/dog`

      ![image-20210526184401773](/static/img/image-20210526184401773.png)

      注意：如果目录下有内容，则`rmdir`指令无法删除该目录

  - `touch`指令

    - 语法

      `touch 文件名`（功能描述：创建一个新文件）

    - 实操——创建一个新文件/创建多个新文件

      ![image-20210526185455119](/static/img/image-20210526185455119.png)

      `touch`指令是可以一次性创建多个新文件的

  - `cp`指令

    - 语法

      `cp [选项] source dest`（功能描述：将`source`拷贝至`dest`目录下）

      常用选项：

      - `-r`：递归复制整个文件夹

    - 实操

      - 将`/home/hello.txt`拷贝到`/home/animal`目录下（拷贝单个文件）

        ![image-20210526190105830](/static/img/image-20210526190105830.png)

      - 将`/home/zwj`整个目录拷贝到`/home/animal`目录下（递归拷贝整个目录）

        ![image-20210526190322572](/static/img/image-20210526190322572.png)

    - 技巧

      如果目标目录下存在相同文件，在使用`cp`指令进行拷贝时，会提示是否覆盖；如果要取消提示，应该使用`\cp`指令，强制进行覆盖不提示

      ![image-20210526191412481](/static/img/image-20210526191412481.png)

  - `rm`指令

    - 语法

      `rm [选项] 文件名或目录名`（功能描述：删除指定文件或目录）

      常用选项：

      - `-r`：递归删除整个文件夹
      - `-f`：强制删除不提示

    - 实操

      - 将`/home/animal/hello.txt`文件删除

        ![image-20210526191844464](/static/img/image-20210526191844464.png)

      - 递归删除整个`/home/animal`目录

        ![image-20210526192015581](/static/img/image-20210526192015581.png)

  - `mv`指令

    - 语法

      `mv 源文件或目录 目标文件或目录`（功能描述：对文件进行重命名或者移动文件）

      `mv`指令的功能会根据其第二个参数的类型不同而拥有不同的功能：

      - 如果第二个参数类型是文件时，该命令实现的是重命名文件或目录的功能，此时第一个参数（源文件或目录）只能有一个
      - 如果第二个参数类型是目录时，该命令实现的是移动文件或目录的功能，此时第一个参数（源文件或目录）可以有多个，`mv`命令会将源文件或目录移动到目标目录下

    - 实操

      - 将`/home/hello.txt`重命名为`pig.txt`

        ![image-20210526195359655](/static/img/image-20210526195359655.png)

      - 将`/home/pig.txt`文件移动到`/root`目录下

        ![image-20210526195706239](/static/img/image-20210526195706239.png)

  - `cat`指令

    - 语法

      `cat [选项] 文件名`（功能描述：以只读的方式打开文件来查看文件内容）

      常用选项：

      - `-n`：显示行号

    - 实操

      查看`/etc/profile`文件内容，并显示行号

      ![image-20210526201420653](/static/img/image-20210526201420653.png)

      `cat`指令只能浏览文件，而不能修改文件

    - 技巧

      一般为了方便浏览，会使用管道符`|`+命令`more`进行分页浏览，语法如下：

      `cat 文件名 | more`（管道符`|`会将管道符前指令输出的内容交给管道符后的指令再执行）

      ![image-20210526204129329](/static/img/image-20210526204129329.png)

  - `more`指令

    `more`指令在启动时就会加载整个文件

    - 语法

      `more 文件名`（功能描述：分页显示文本文件内容，能向下翻页，但不能向上翻页）

    - 实操——使用`more`分页查看`/etc/profile`

      ![image-20210526205423359](/static/img/image-20210526205423359.png)

    - `more`指令快捷键

      ![image-20210526205502430](/static/img/image-20210526205502430.png)

  - `less`指令

    `less`指令在启动时不会加载整个文件，而是根据显示加载内容，浏览大文件效率很高

    - 语法

      `less 文件名`（功能描述：分页显示文本文件内容，能向上、向下翻页）

    - 实操——使用`less`分页查看`/etc/profile`

      ![image-20210526212853070](/static/img/image-20210526212853070.png)

    - 快捷键

      ![image-20210526212906883](/static/img/image-20210526212906883.png)

  - `>`指令

    - 语法

      `指令 > 文件名`（功能描述：将输出重定向至指定文件中）

      `>`指令会覆盖目标文件的内容：

      - 如果目标文件存在时会先删除原文件，再重新创建文件，然后把内容写入该文件
      - 如果目标文件不存在则直接创建文件

    - 实操——将指令`ls -l`多次输出重定向至`a.txt` 中，然后查看`a.txt`内容

      ![image-20210526220218501](/static/img/image-20210526220218501.png)

      `a.txt`中的内容如下：

      ![image-20210526220246721](/static/img/image-20210526220246721.png)

      可以看出，即使多次使用`>`指令输出重定向，也只会有一份内容，因为每次输出至目标文件，都会先覆盖目标文件原有的内容

  - `>>`指令

    - 语法

      `指令 >> 文件名`（功能描述：将输出重定向至指定文件中）

      `>>`指令会将输出的内容追加至文件的尾部：

      - 如果文件存在时直接在文件末尾进行内容追加，不会删除原文件
      - 如果目标文件不存在则直接创建文件

    - 实操——将指令`ls -l`多次输出重定向至`b.txt` 中，然后查看`b.txt`内容

      ![image-20210526220803667](/static/img/image-20210526220803667.png)

      `b.txt`中的内容如下：

      ![image-20210526220844967](/static/img/image-20210526220844967.png)

      ​	可以看出，多次使用`>>`指令输出重定向，文件中也会保存多份内容，因为每次输出至目	标文件，都会将内容追加到文件末尾

  - `echo`指令

    - 语法

      `echo [选项] [输出内容]`（功能描述：输出内容到控制台）

    - 实操——使用`echo`指令输出`hello,world!`

      ![image-20210526221244170](/static/img/image-20210526221244170.png)

  - `head`指令

    - 语法

      `head [选项] 文件名`（功能描述：查看文件开头内容，默认显示前10行内容）

      常用选项：

      - `-n num`：查看文件头`num`行内容

    - 实操——查看`/etc/profile`前5行内容

      ![image-20210526222418494](/static/img/image-20210526222418494.png)

  - `tail`指令

    - 语法

      `tail [选项] 文件名`（功能描述：查看文件末尾内容，默认显示后10行内容）

      常用选项：

      - `-n num`：查看文件后`num`行内容
      - `-f`：实时追踪该文件的所有更新

    - 实操

      - 查看`/etc/profile`最后5行的内容

        ![image-20210526230743291](/static/img/image-20210526230743291.png)

      - 实时监控`mydate.txt`，然后再实时追加内容，来查看文件的变化

        ![image-20210526232054561](/static/img/image-20210526232054561.png)

        使用`tail -f`指令对文件实时监控，当其他用户对该文件进行操作时，该文件的最新版本都会实时显示给当前用户

  - `ln`指令

    - 语法

      `ln -s [源文件或目录] [软链接名]`（功能描述：给源文件创建一个软链接。软链接也叫符号链接，类似于 windows 里的快捷方式，主要存放了链接其他文件的路径）

    - 实操
    
      - 在`/home/`目录下创建一个指向`/root`目录的软链接
    
        ![image-20210527084618094](/static/img/image-20210527084618094.png)
    
      - 删除软链接`linkToRoot`
    
        ![image-20210527084738540](/static/img/image-20210527084738540.png)
    
    - 注意
    
      软链接相当于一个快捷方式，使用`pwd`指令查看目录时，仍是软链接所在目录，而使用`ls -l`指令查看，就跳转至软链接链接的目录下
    
      ![image-20210527085155329](/static/img/image-20210527085155329.png)
    
  - `history`指令
  
    - 语法
  
      `history`（功能描述：查看已经执行过的历史命令）
  
    - 实操
  
      - 显示所有的历史命令
  
        ![image-20210527103051312](/static/img/image-20210527103051312.png)
  
      - 显示最近使用过的10个历史指令
  
        ![image-20210527103311379](/static/img/image-20210527103311379.png)
  
      - 执行历史列表中的第19号命令
  
        ![image-20210527103515567](/static/img/image-20210527103515567.png)
  
        通过`! num`的形式，可以直接执行历史列表中的num号命令
  
- 时间日期类相关指令

  - `date`指令 —显示当前日期

    - 语法

      - `date`（功能描述：显示当前时间）
      - `date "+%[YmdHMS]"`（功能描述：显示当前年/月/日/时/分/秒）
      - `date "+%Y-%m-%d %H:%M:%S"`（功能描述：显示当前年月日时分秒）

    - 实操

      - 显示当前时间信息

        ![image-20210527104826236](/static/img/image-20210527104826236.png)

      - 显示当前年月日时分秒

        ![image-20210527104946077](/static/img/image-20210527104946077.png)

  - `date`指令—设置日期

    - 语法

      `date -s` （功能描述：将当前时间设置为`s`表示的时间。`s`是一个格式化的时间字符串）

    - 实操——设置系统当前时间为`2021-05-27 12：25：35`
    
      ![image-20210527121433653](/static/img/image-20210527121433653.png)
    
  - `cal`指令
  
    - 语法
  
      `cal [选项]`（功能描述：不加选项，显示本月日历）
  
    - 实操——显示当前日历
  
      ![image-20210527121759007](/static/img/image-20210527121759007.png)
  
- 搜索查找类相关指令

  - `find`指令

    - 语法

      `find [搜索范围] [选项]`（功能描述：递归地在搜索范围中查找满足条件的文件或目录）

      常用选项：

      ![image-20210527123112745](/static/img/image-20210527123112745.png)

    - 实操

      - 根据名称查找`/home`目录下的`.txt`文件（可以使用正则表达式）

        ![image-20210527125042258](/static/img/image-20210527125042258.png)

      - 查找`/home`目录下，文件拥有者为`potato`的文件

        ![image-20210527124227477](/static/img/image-20210527124227477.png)

      - 查找整个Linux系统下大于20M的文件

        ![image-20210527124922565](/static/img/image-20210527124922565.png)

        `+num`表示大于`num`，`-num`表示小于`num`，`num`表示等于`num`

  - `locate`指令

    - 语法

      `locate 文件名`（功能描述快速定位文件路径）

      `locate`指令利用事先建立的系统中所有文件名称及路径的locate 数据库实现快速定位给定的文件，因为无需遍历整个系统，所以查询速度较快

    - 实操——使用 locate 指令快速定位 `ok1.txt` 文件路径

      ![image-20210527125603150](/static/img/image-20210527125603150.png)

  - `grep`指令和管道符`|`

    - 管道符`|`

      表示将前一个命令的处理结果输出传递给后面的命令处理

    - `grep`

      - 语法

        `grep [选项] 查找内容 源文件`

        常用选项：

        - `-n`：显示匹配行及其行号
        - `-i`：忽略字母大小写

      - 实操——在`a.txt`文件中，查找`yes`所在行并显示行号

        ![image-20210527130239430](/static/img/image-20210527130239430.png)

- 压缩和解压类

  - `gzip`/`gunzip`指令

    - `gzip`

      - 语法

        `gzip 文件名`（功能描述：压缩文件，只能将文件压缩为`*.gz`文件）

      - 实操——将`/home`目录下的`a.txt`文件进行压缩

        ![image-20210527130622534](/static/img/image-20210527130622534.png)

    - `gunzip`

      - 语法

        `gunzip 文件名`（功能描述：解压文件）

      - 实操——将`/home`下的`a.txt.gz`进行解压

        ![image-20210527130802505](/static/img/image-20210527130802505.png)

    - 注意

      使用 `gzip` 或`gunzip`指令对文件进行压缩或解压后，是不会保留原来的文件

  - `zip`/`unzip`指令

    - `zip`

      - 语法

        `zip [选项] 压缩后的压缩包名 压缩的内容`（功能描述：压缩文件和目录）

        常用选项：

        - `-r`：递归压缩，用于压缩目录

      - 实操——将`/home`目录下的所有文件压缩成`mypackage.zip`

        ![image-20210527131749354](/static/img/image-20210527131749354.png)

    - `unzip`

      - 语法

        `unzip [选项] 解压的压缩包名`（功能描述：解压缩文件）

        常用选项：

        - `-d dir`：指定解压后文件的存放目录，`dir`表示一个目录

      - 实操——将`mypackage.zip`解压到`/opt`目录下

        ![image-20210527132200021](/static/img/image-20210527132200021.png)

  - `tar`指令

    - 语法

      `tar [选项] 打包后的文件名 打包的内容`（功能描述：打包压缩和解压缩，压缩后的文件格式为`*.tar.gz`）

      常用选项：

      - `-c`：产生`.tar`打包文件
      - `-v`：显示详细信息
      - `-f`：指定压缩后的文件名
      - `-z`：打包同时压缩
      - `-x`：解包`.tar`文件
      - `-C`：指定解压后文件的存放位置

    - 实操

      - 压缩多个文件,将`/home/a.txt`和`/home/b.txt`压缩成`a.tar.gz`

        ![image-20210527133403594](/static/img/image-20210527133403594.png)

      - 将`/home`的目录压缩成`myhome.tar.gz`

        ![image-20210527133950007](/static/img/image-20210527133950007.png)

      - 将`a.tar.gz`解压到当前目录

        ![image-20210527134115271](/static/img/image-20210527134115271.png)

      - 将`myhome.tar.gz`解压到`/opt`目录下

        ![image-20210527134614126](/static/img/image-20210527134614126.png)

## 7.权限管理

在Linux中每个文件/目录有所有者、所在组、其他组的概念，文件/目录对于这三者有不同的权限

- 文件/目录的所有者

  一般是文件/目录的创建者，即谁创建了该文件，谁就是该文件的所有者

  - 查看文件的所有者

    ![image-20210527143758960](/static/img/image-20210527143758960.png)

  - 修改文件所有者

    - 指令

      - `chown [选项] 用户名 文件名`
      - `chown [选项] 用户名:组名 文件名`（同时修改文件的所有者和所在组）

      常用选项：

      - `-R`：可以递归修改一个目录的所有子文件或子目录的所有者

    - 实操——使用 `root` 用户创建一个文件`apple.txt`，然后将其所有者修改成`potato`用户

      ![image-20210527144057799](/static/img/image-20210527144057799.png)

- 文件/目录所在组

  当某个用户创建了一个文件后，默认这个文件的所在组就是该用户所在的组

  - 查看文件/目录所在组

    ![image-20210527144514373](/static/img/image-20210527144514373.png)

  - 修改文件所在组

    - 指令

      `chgrp [选项] 组名 文件名`

      常用选项：

      - `-R`：可以递归修改一个目录的所有子文件或子目录的所在组

    - 实操——使用`root`用户创建文件`orange.txt` ，并将该文件所在组修改为`potato`组

      ![image-20210527144742417](/static/img/image-20210527144742417.png)

- 其他组

  除文件的所有者和所在组的用户外，系统的其他用户都是文件的其他组

当一个用户操作文件/目录时，系统会判断用户是属于该文件/目录的拥有者/所在组/其他组，而给用户分配不同的权限

- 查看文件/目录的类型和权限

  ![image-20210527150246131](/static/img/image-20210527150246131.png)

  以`apple.txt`文件为例，`-rw-r--r--`共10位字符：

  - 第0位表示文件的类型：
    - `d`：表示目录
    - `-`：表示普通文件
    - `l`：表示软链接
    - `c`：表示字符设备（键盘、鼠标之类）
    - `b`：块设备（硬盘之类）
  - 第1-3位表示文件所有者拥有该文件的权限
  - 第4-6位表示文件所在组下的用户拥有该文件的权限
  - 第7-9位表示其他用户拥有该文件的权限

- `rwx`权限详解

  - `r`（read）：

    - 如果文件类型是普通文件

      表示可以读取，查看

    - 如果文件类型是目录

      表示可以读取，`ls`指令查看目录内容

  - `w`（write）：

    - 如果文件类型是普通文件

      表示可以修改该文件，但是不能删除该文件。删除该文件的前提必须是对该文件所在目录有写权限

    - 如果文件类型是目录

      表示可以修改该目录，即在目录内创建/删除文件和重命名目录

  - `x`（execute）：

    - 如果文件类型是普通文件

      表示该文件可以被执行

    - 如果文件类型是目录

      表示可以进入该目录

- 查看文件其他信息

  ![image-20210527153714652](/static/img/image-20210527153714652.png)

- 修改文件/目录的权限

  - 指令

    - 使用+、-、=变更权限

      - `chmod u=[rwx],g=[rwx],o=[rwx] 文件/目录名`（`u`表示所有者，`g`表示所在组，`o`表示其他组）
      - `chmod [ugo]+[rwx]`（增加权限）
      - `chmod [ugo]-[rwx]`（删除权限）

    - 通过数字变更权限

      规则：r=4，w=2，x=1

      例：`chmod 751 文件目录名`（相当于`chmod u=rwx,g=rx,o=x`）

  - 实操

    - 给 `/home/a.txt` 文件的所有者读写执行的权限，给所在组读执行权限，给其它组读执行权限

      ![image-20210527155815946](/static/img/image-20210527155815946.png)

    - 给 `/home/a.txt` 文件的所有者除去执行的权限，增加所在组写的权限

      ![image-20210527160110820](/static/img/image-20210527160110820.png)

## 8.crond任务调度

 `crond`是Linux下用来周期性的执行某种任务或等待处理某些事件的一个守护进程

任务调度：是指系统在某个时间执行的特定的命令或程序

任务调度分类：

- 系统任务调度：系统周期性所要执行的工作，比如写缓存数据到硬盘、日志清理等

- 用户任务调度：用户定期要执行的工作，比如用户数据备份、定时邮件提醒等

Linux的`crontab`指令可以供用户设置定期执行的任务：

- 语法

  `crontab [选项]`

  常用选项：

  - `-e`：编辑`crontab`定时任务
  - `-l`：查询`crontab`任务
  - `-r`：删除当前用户所有的`crontab`任务

- 实操——编辑`crontab`定时任务，实现每分钟执行一次`ls –l /root >> /home/a.txt` 指令

  - 首先使用指令`crontab -e`，创建一个`crontab`任务文件来编辑任务代码
  - 在任务文件中输入任务代码：`*/1 * * * * ls -l /root >> /home/a.txt` 并退出保存
  - 之后每过一分钟该任务就会被执行一次

  ![image-20210527181021140](/static/img/image-20210527181021140.png)

- `crontab`文件任务代码说明

  `*/1 * * * *`表示的是每隔一分钟执行一次

  ![image-20210527181232952](/static/img/image-20210527181232952.png)

  |      |                             |
  | ---- | --------------------------- |
  |      | ![img](/static/img/wps3.png) |

## 9.Linux磁盘分区、挂载

- Linux分区

  Linux分区通过挂载，将一个分区映射到一个文件目录下

- Linux挂载

  Linux是以树的结构存储文件的，任何硬件设备也都是文件，它们各有自己的一套文件系统（文件目录结构），因此产生了一个问题：当在Linux系统中使用这些硬件设备时，只有将Linux本身的文件目录与硬件设备的文件目录合二为一，硬件设备才能被我们所使用

  Linux通过**挂载**，将硬件设备的文件目录和Linux本身的文件目录合二为一

  **挂载，指的就是将设备文件中的顶级目录连接到Linux根目录下的某一目录（最好是空目录），访问此目录就等同于访问设备文件，而该目录也叫挂载点**

  例：假设我们想通过指令访问某个U盘中的数据，但是此时U盘和Linux系统文件分属两个文件系统，是无法通过指令找到U盘文件，所以就需要将U盘和根目录下的某个文件进行挂载

  ![image-20210527211155921](/static/img/image-20210527211155921.png)

  挂载操作如下：

  - 在Linux根目录下新建一个目录`/sdb -u`
  - 通过挂载指令将U盘文件系统挂载到此目录下
  - 此时U盘文件系统已经成为 Linux 文件系统目录的一部分，访问 /sdb-u/ 就等同于访问 U 盘

  ![image-20210527211554928](/static/img/image-20210527211554928.png)

- Linux硬盘说明

  - Linux硬盘分IDE硬盘和SCSI硬盘，目前基本上是 SCSI 硬盘

    -  IDE 硬盘

      驱动器标识符为“hdx~”,其中“hd”表明分区所在设备的类型，这里是指 IDE 硬盘了。“x”为盘号（a 为基本盘，b 为基本从属盘，c 为辅助主盘，d 为辅助从属盘）,“~”代表分区，前四个分区用数字 1 到 4 表示，它们是主分区或扩展分区，从 5 开始就是逻辑分区。例，hda3 表示为第一个 IDE 硬盘上的第三个主分区或扩展分区,hdb2 表示为第二个 IDE 硬盘上的第二个主分区或扩展分区。

    -  SCSI 硬盘

      则标识为“sdx~”，SCSI 硬盘是用“sd”来表示分区所在设备的类型的，其余则和 IDE 硬盘的表示方法一样

- 查看当前系统的分区情况

  - 指令

    `lsblk [选项]`

    常用选项：

    - `-f`：输出有关文件系统的信息

  - 实操

    ![image-20210527215305191](/static/img/image-20210527215305191.png)

- **实操——增加一块硬盘并且挂载到/home/newdisk**

  - 首先在虚拟机中增加一块硬盘，如图

    ![image-20210527220033496](/static/img/image-20210527220033496.png)

  - 重启虚拟机，使用`lsblk`指令查看磁盘分区情况，如下图

    ![image-20210527221534391](/static/img/image-20210527221534391.png)

    ​	此时新增的硬盘`sdb`还未进行分区

  - 为新增硬盘`sdb`进行分区

    - 指令

      `fdisk 设备名`

    - 实操

      ![image-20210527222030205](/static/img/image-20210527222030205.png)

      分区指令：`fdisk /dev/sdb`

      开始对`/dev/sdb`进行分区：

      - 命令`m`：显示命令列表
      - 命令`n`：新增一个分区
      - 命令`p`：选择新增的分区类型为主分区
      - 命令`w`：写入分区并退出

    - 分区后重新使用指令`lsblk -f`查看分区情况，会发现新增硬盘在分区后还没有对应的文件系统类型、uuid及挂载点

      ![image-20210527222751772](/static/img/image-20210527222751772.png)

    - 格式化新增磁盘

      - 指令

        `mkfs [选项] 分区`（功能描述：创建一个Linux文件系统）

        常用选项：

        - `-t`：指定文件系统类型

      - 实操

        为`sdb1`分区创建一个`ext4`文件系统类型

        ![image-20210527223057988](/static/img/image-20210527223057988.png)

    - 格式化后重新使用指令`lsblk -f`查看分区情况，会发现新增磁盘格式化后拥有了自己的文件系统类型和uuid

      ![image-20210527223419085](/static/img/image-20210527223419085.png)

    - 将分区与`/home/newdisk`目录挂载

      - 指令

        `mount 设备名 目录名`

      - 实操

        ![image-20210527224128119](image-20210527224128119.png)

        此时再次查看会发现分区`sdb1`已经和目录`/home/newdisk`挂载上

        ![image-20210527224459151](/static/img/image-20210527224459151.png)

    - 通过`mount`指令进行的是临时挂载，在虚拟机重启后，设备与目录的映射就会被卸载，因此还需要修改对应的配置文件来实现永久挂载

      - 修改`/etc/fstab`，将分区和挂载点写入文件中

        ![image-20210527225133352](/static/img/image-20210527225133352.png)

      - 使用指令`mount -a`即可生效文件

- 磁盘情况查询

  - 指令

    `df [选项]`

    常用选项：

    - `-l`：只显示本地文件系统使用状况
    - `-h`：用常见的格式显示出大小

  - 实操

    ![image-20210527230016853](/static/img/image-20210527230016853.png)

- 查询指定目录的磁盘占用情况

  - 指令

    `du [选项] 目录名`

     常用选项：

    - `-h`：为每个数附加一个表示大小单位的字母
    - `-s`：指定目录占用大小汇总
    - `-a`：显示对所有文件的统计，而不只是包含子目录
    - `-c`：列出明细的同时，增加汇总值
    - `--max-depth=n`	子目录深度为n

  - 实操——查询`/opt`目录的磁盘占用情况，深度为1

    ![image-20210527231547303](/static/img/image-20210527231547303.png)

- 磁盘情况——工作实用指令

  - 统计`/home`目录下文件的个数

    ![image-20210527232027571](/static/img/image-20210527232027571.png)

  - 统计`/home`目录下目录的个数

    ![image-20210527232229540](/static/img/image-20210527232229540.png)

  - 统计`/home`目录下文件的个数，包括子目录里的文件个数

    ![image-20210527232455800](/static/img/image-20210527232455800.png)

  - 统计文件夹下目录的个数，包括子目录里的目录个数

    ![image-20210527232338618](/static/img/image-20210527232338618.png)

  - 以树状显示目录结构

    ![image-20210527232631077](/static/img/image-20210527232631077.png)

## 10.进程管理

- 进程的基本介绍
  - 在Linux中，每个执行的程序（代码）都称为一个进程。每一个进程都分配一个 ID 号
  - 每一个进程，都会对应一个父进程，而这个父进程可以复制多个子进程
  - 每个进程都可能以两种方式存在的。前台与后台，所谓前台进程就是用户目前的屏幕上可以进行操作的。后台进程则是实际在操作，但由于屏幕上无法看到的进程，通常使用后台方式执行
  - 一般系统的服务都是以后台进程的方式存在，而且都会常驻在系统中。直到关机才才结束

- 显示系统执行的进程

  - 指令

    `ps [选项]`

    常用选项：

    - `-a`：显示当前终端的所有进程信息
    - `-u`：以用户的格式显示进程信息
    - `-x`：显示后台进程运行的参数
    - `-e`：显示所有进程
    - `-f`：以全格式显示进程的信息

  - 实操

    - 以用户格式显示对当前终端的所有进程信息及后台进程运行的参数
  
      ![image-20210528002521662](/static/img/image-20210528002521662.png)
  
    - 以全格式显示当前所有的进程
  
      ![image-20210528081531817](/static/img/image-20210528081531817.png)
  
- 终止进程

  - 指令

    - `kill [选项] 进程号`（功能描述：通过进程号杀死进程）

      常用选项：

      - `-9`：强迫进程立即停止

    - `killall 进程名称`（功能描述：通过进程名杀死进程，支持通配符）

  - 实操

    - 杀死所有的`gedit`进程

      ![image-20210528083140645](/static/img/image-20210528083140645.png)

    - 杀死`bash`终端

      `bash`终端是Linux的核心态进程，无法通过`kill`杀死，必须使用选项`-9`强制删除

      ![image-20210528083549425](/static/img/image-20210528083549425.png)

- 查看进程树

  - 指令

    `pstree [选项]`（功能描述：以树型结构显示所有进程）

    常用选项：

    - `-p`：显示进程的PID
    - `-u`：显示进程的所属用户

  - 实操

    - 以树状的形式显示进程的 pid

      ![image-20210528084023674](/static/img/image-20210528084023674.png)

    - 以树状的形式显示进程的用户

      ![image-20210528084059173](/static/img/image-20210528084059173.png)

- 动态监控进程

  - `top`指令

    - 语法

      `top [选项]`（功能描述：与`ps`命令相似，用来显示正在执行的进程，但是与`ps`指令不同的是，`top`指令在执行一段时间后，会更新正在运行的进程）

      常用选项：

      - `-d 秒数`：指定`top`指令每隔几秒更新，默认是3秒
      - `-i`：使`top`不显示任何闲置或者僵尸进程
      - `-p pid`：通过指定监控进程ID来仅仅监控某个进程的状态

    - 交互操作

      - `P`：以CPU使用率排序，默认就是此项
      - `M`：以内存的使用率排序
      - `N`：以PID排序
      - `q`：退出`top`
      - `u`：按下`u`后输入用户名，就会只显示特定用户的进程
      - `k`：按下`k`后输入要结束的进程id，即可杀死该进程

    - 实操

      - 查询当前正在执行的进程

        ![image-20210528114549302](/static/img/image-20210528114549302.png)

      - 监视特定用户

        先使用`top`指令查看所有进程，然后按`u`，输入需要监控的特定用户名，回车即可

        ![image-20210528113633480](/static/img/image-20210528113633480.png)

      - 终止指定的进程

        先使用`top`指令查看所有进程，然后按`k`，输入需要终止的进程id，回车即可

        ![image-20210528113902348](/static/img/image-20210528113902348.png)

      - 指定`top`更新时间间隔为10s

        ![image-20210528114034312](/static/img/image-20210528114034312.png)

## 11.服务管理

服务本质上是守护进程，运行在后台，通常都会监听某个端口，等待其他程序的请求，比如`mysql`、`sshd`等

- `systemctl`指令

  - 语法

    `systemctl [start|stop|restart|reload|status] 服务名 `（功能描述：开启/停止/重启/重新加载/查看当前服务状态）

  - 实操

    - 查看当前防火墙的状况

      ![image-20210528085433223](/static/img/image-20210528085433223.png)

    - 关闭防火墙

      ![image-20210528085510997](/static/img/image-20210528085510997.png)

    - 重启防火墙

      ![image-20210528090445622](/static/img/image-20210528090445622.png)

  - 注意

    使用`systemctl`指令对服务的操作都是立即生效，但是在系统重启后，还是会回归以前的服务设置

- 查看服务名

  - 使用`setup`指令进入系统服务界面查看服务名称

    ![image-20210528091101605](/static/img/image-20210528091101605.png)

  - 进入目录`/etc/init.d/`查看服务名称

    ![image-20210528091237497](/static/img/image-20210528091237497.png)

- 服务与运行级别

  服务在不同的运行级别是具有不同的配置，比如`sshd`服务可能在运行级别3的配置是开机自启动，但是在运行级别5的配置是开机不启动

  CentOS7开机流程说明：

  ![image-20210528093734337](/static/img/image-20210528093734337.png)

- `chkconfig`指令

  - 语法

    - `chkconfig --list 服务名`（功能描述：显示当前所有系统服务在每个运行级别下的配置）
    - `chkconfig --level [0-6] 服务名 on/off`（功能描述：永久设置某个服务在某个运行级别下启动或关闭）

  - 实操

    - 请显示当前系统所有服务的各个运行级别的运行状态

      ![image-20210528092718467](/static/img/image-20210528092718467.png)

    - 将 `sshd` 服务在运行级别 5 下设置为不自动启动

      ![image-20210528094250748](/static/img/image-20210528094250748.png)

    - 在所有运行级别下，开启防火墙

      ![image-20210528094332094](/static/img/image-20210528094332094.png)

- 监控系统网络服务情况

  - `netstat`指令

    - 语法

      `netstat [选项]`

      常用选项：

      - `-a`：显示所有正在或不在侦听的套接字
      - `-n`：显示数字形式地址而不是去解析主机、端口或用户名
      - `-p`：显示套接字所属进程的PID和名称

    - 实操——查看系统所有的网络服务

      ![image-20210528115414024](/static/img/image-20210528115414024.png)

## 12.RPM和YUM

- rpm包管理

  RPM 是 RedHat Package Manager（RedHat 软件包管理工具）的缩写，是一种包管理工具，它生成具有.RPM 扩展名的文件，并且只能安装已经下载到本机的rpm包

  - rpm的相关指令

    - 语法

      `rpm [选项]`

      常用选项：

      - `-qa`：查询所有已安装的包
      - `-qi 软件名`：查询软件对应的rpm包信息
      - `-ql 软件名`：查询软件对应的rpm包中的文件
      - `-qf 文件名`：查询拥有该文件的所有rpm包
      - `-e rpm包名称`：卸载该rpm包对应的软件
      - `-ivh rpm包全路径名称`：安装该rpm包（`i`=install安装，`v`=verbos提示，`h`=hash进度条）

    - 实操

      - 查询当前linux系统是否安装了`firefox`

        ![image-20210528120802890](/static/img/image-20210528120802890.png)

      - 查询`firefox`对应的rpm包信息

        ![image-20210528120937748](/static/img/image-20210528120937748.png)

      - 查询`firefox`对应的rpm包中的文件

        ![image-20210528121054773](/static/img/image-20210528121054773.png)

      - 查询文件`/etc/passwd`所属的rpm包

        ![image-20210528121210351](/static/img/image-20210528121210351.png)

      - 卸载`firefox`软件

        ![image-20210528121450685](/static/img/image-20210528121450685.png)

      - 安装`firefox`软件

        首先得先从网上下载一个`firefox`包到虚拟机上，再通过`rpm -ivh 全路径名`进行安装

        ![image-20210528123949404](/static/img/image-20210528123949404.png)

    - 注意

      如果卸载的rpm包与其他rpm包具有依赖关系，卸载时是会产生错误的，如果执意要删除该rpm包，可以使用指令`rpm -e --nodeps 包名`

- yum

  Yum 是一个Shell前端软件包管理器。基于RPM包管理，能够从指定的服务器自动下载 RPM 包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软件包。使用 yum 的前提是可以联网

  - yum的相关指令

    - 语法

      `yum [选项] 操作 包名`

      常用选项：

      - `list`：查询yum服务器上的所有软件包

      常用操作：

      - `install`：下载安装

    - 实操

      - 查询yum服务器上是否有`firefox`的rpm包

        ![image-20210528124628164](/static/img/image-20210528124628164.png)

      - 安装最新版`firefox`

        ![image-20210528124803096](/static/img/image-20210528124803096.png)

